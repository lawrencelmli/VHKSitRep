htmlOutput("c19_cc_flow"))
)
) #/box
), #/fluidRow
fluidRow(
box(title = "Assessment Units", width = 12, collapsible = T,
box(title = "AU One", width = 6, collapsible = T,
column(width = 6,
infoBoxOutput("c19_au11", width = NULL),
infoBoxOutput("c19_au12", width = NULL),
infoBoxOutput("c19_au13", width = NULL)
),
column(width = 6,
infoBoxOutput("c19_au14", width = NULL),
infoBoxOutput("c19_au15", width = NULL)
)
),
box(title = "AU Two", width = 6, collapsible = T,
column(width = 6,
infoBoxOutput("c19_au21", width = NULL),
infoBoxOutput("c19_au22", width = NULL),
infoBoxOutput("c19_au23", width = NULL)
),
column(width = 6,
infoBoxOutput("c19_au24", width = NULL),
infoBoxOutput("c19_au25", width = NULL)
)
),
box(title = "Additional Capacity", collapsible = T, collapsed = T, width = 6,
htmlOutput("c19_add")
)
)
)
)
) #/tabItems
) #/dashboardBody
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
library(shiny); runApp('app02.R')
runApp('app02.R')
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
install.packages(c("backports", "car", "carData", "dbplyr", "DescTools", "ellipsis", "foreign", "haven", "httpuv", "iNZightTools", "jomo", "labelled", "modelr", "nlme", "questionr", "RcppArmadillo", "rsvg", "rversions", "servr", "sp", "tidyr", "tinytex", "xfun"))
shiny::runApp()
runApp()
runApp()
runApp()
library(tidyverse)
library(readxl)
library(stringr)
library(stringi)
setwd("D:\\Lawrence\\Documents\\R_Projects\\VHKSitRep")
AU1_830 <- read_excel("SitRep01.xlsm", sheet = 3, range = "O44:S44", col_names = F)
AU2_830 <- read_excel("SitRep01.xlsm", sheet = 3, range = "O47:S47", col_names = F)
AU_830 <- rbind(AU1_830, AU2_830)
AU_830 <- AU_830 %>%
select(-...2) %>%
select("Now" = ...1,
"Beds" = ...3,
"DC" = ...4,
"Ongoing" =...5)
view(AU_830)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
EC_1300 <- read_excel("SitRep01.xlsm", sheet = 3, range = "A6:F13", col_names = F)
EC_1300$...1 <- gsub(":", "", EC_1300$...1)
View(EC_1300)
EC_1300 <- read_excel("SitRep01.xlsm", sheet = 4, range = "A6:F13", col_names = F)
EC_1300$...1 <- gsub(":", "", EC_1300$...1)
EC_1300 <- EC_1300 %>%
select("FLow" = ...1,
"Numbers" = ...6)
PC_1300 <- read_excel("SitRep01.xlsm", sheet = 4, range = "H6:K13", col_names = F)
PC_1300$...1 <- gsub(":", "", PC_1300$...1)
View(PC_1300)
PC_1300 <- PC_1300 %>%
select("Flow" = ...1,
"Numbers" = ...4)
total_1300 <- read_excel("SitRep01.xlsm", sheet = 4, range = "M6:O13", col_names = F)
View(total_1300)
total_1300$...1 <- gsub(":", "", total_1300$...1)
total_1300 <- total_1300 %>%
select("Flow" = ...1,
"Numbers" = ...3)
columns_1300 <- c("Ward",
"Access",
"Specialty",
"Empty",
"Electives",
"DC_Expect",
"DC_1pm",
"End_Pos")
ortho_1300 <- read_excel("SitRep01.xlsm", sheet = 4, range = "A44:H46", col_names = columns_1300)
View(ortho_1300)
runApp()
ED_830 <- read_excel("SitRep01.xlsm", sheet = 3, range = "N18:V18", col_names = F)
colnames(ED_830) <- c("Total",
"Longest",
"Assessment",
"Three_hours",
"DTA",
"Midnight",
"RN_Shrot",
"nRN_Short",
"Safe")
ED_830 <- read_excel("SitRep01.xlsm", sheet = 3, range = "N18:V18", col_names = F)
View(ED_830)
colnames(ED_830) <- c("Total",
"Longest",
"Assessment",
"Three_hours",
"DTA",
"Midnight",
"RN_Shrot",
"nRN_Short",
"Safe")
ED_830 <- read_excel("SitRep01.xlsm", sheet = 4, range = "J18:P18", col_names = F)
colnames(ED_830) <- c("Total",
"Longest",
"Assessment",
"Three_hours",
"DTA",
"Breaches",
"Midnight")
ED_1300 <- read_excel("SitRep01.xlsm", sheet = 4, range = "J18:P18", col_names = F)
colnames(ED_1300) <- c("Total",
"Longest",
"Assessment",
"Three_hours",
"DTA",
"Breaches",
"Midnight")
View(ED_1300)
if(is.character(ED_1300$Longest) == T){
ED_1300$Longest <- ED_1300$Longest
}else{
ED_1300$Longest <- format(ED_1300$Longest, "%T")
}
if(is.character(ED_1300$Assessment) == T){
ED_1300$Assessment <- ED_1300$Assessment
}else{
ED_1300$Assessment <- format(ED_1300$Assessment, "%T")
}
cc_1300 <- read_excel("SitRep01.xlsm", sheet = 4, range = "J25:O29", col_names = F)
colnames(cc_1300) <- c("Ward",
"Empty",
"Fit",
"Admissions",
"Discharges",
"End_Pos")
cc_1300[, 1] <- c("ITU",
"SHDU",
"MHDU",
"RHDU",
"CCU")
View(cc_1300)
add_1300 <- read_excel("SitRep01.xlsm", sheet = 4, range = "J34:N40", col_names = F)
View(add_1300)
add_1300 <- select(add_1300, -...3, -...5)
colnames(add_1300) <- c("Ward", "Agreed", "Used")
add_1300 <- read_excel("SitRep01.xlsm", sheet = 4, range = "J34:N40", col_names = F)
add_1300 <- select(add_1300, -...3, -...5)
colnames(add_1300) <- c("Ward", "Agreed", "Used")
AU1_1300 <- read_excel("SitRep01.xlsm", sheet = 4, range = "O44:S44", col_names = F)
AU2_1300 <- read_excel("SitRep01.xlsm", sheet = 4, range = "O47:S47", col_names = F)
AU_1300 <- rbind(AU1_1300, AU2_1300)
AU_1300 <- AU_1300 %>%
select(-...2) %>%
select("Now" = ...1,
"Beds" = ...3,
"DC" = ...4,
"Ongoing" =...5)
View(AU_1300)
AU1_1300 <- read_excel("SitRep01.xlsm", sheet = 4, range = "J44:N44", col_names = F)
View(AU1_1300)
AU2_1300 <- read_excel("SitRep01.xlsm", sheet = 4, range = "J47:N47", col_names = F)
View(AU2_1300)
AU_1300 <- rbind(AU1_1300, AU2_1300)
View(AU_1300)
AU_1300 <- AU_1300 %>%
select(-...2) %>%
select("Now" = ...1,
"Beds" = ...3,
"DC" = ...4,
"Ongoing" =...5)
EC_1700 <- read_excel("SitRep01.xlsm", sheet = 5, range = "A6:F13", col_names = F)
EC_1700$...1 <- gsub(":", "", EC_1700$...1)
EC_1700 <- EC_1700 %>%
select("FLow" = ...1,
"Numbers" = ...6)
View(EC_1700)
PC_1700 <- read_excel("SitRep01.xlsm", sheet = 5, range = "H6:K13", col_names = F)
PC_1700$...1 <- gsub(":", "", PC_1700$...1)
PC_1700 <- PC_1700 %>%
select("Flow" = ...1,
"Numbers" = ...4)
View(PC_1700)
total_1700 <- read_excel("SitRep01.xlsm", sheet = 5, range = "M6:O13", col_names = F)
total_1700$...1 <- gsub(":", "", total_1700$...1)
total_1700 <- total_1700 %>%
select("Flow" = ...1,
"Numbers" = ...3)
View(total_1700)
ED_1700 <- read_excel("SitRep01.xlsm", sheet = 5, range = "J18:P18", col_names = F)
View(ED_1700)
colnames(ED_1700) <- c("Total",
"Longest",
"Assessment",
"Three_hours",
"DTA",
"Breaches",
"Midnight")
if(is.character(ED_1700$Longest) == T){
ED_1700$Longest <- ED_1700$Longest
}else{
ED_1700$Longest <- format(ED_1700$Longest, "%T")
}
if(is.character(ED_1700$Assessment) == T){
ED_1700$Assessment <- ED_1700$Assessment
}else{
ED_1700$Assessment <- format(ED_1700$Assessment, "%T")
}
cc_1700 <- read_excel("SitRep01.xlsm", sheet = 5, range = "J25:O29", col_names = F)
View(cc_1700)
colnames(cc_1700) <- c("Ward",
"Empty",
"Fit",
"Admissions",
"Discharges",
"End_Pos")
cc_1700[, 1] <- c("ITU",
"SHDU",
"MHDU",
"RHDU",
"CCU")
add_1700 <- read_excel("SitRep01.xlsm", sheet = 5, range = "J34:N40", col_names = F)
View(add_1700)
add_1700 <- select(add_1700, -...3, -...5)
colnames(add_1700) <- c("Ward", "Agreed", "Used")
AU1_1700 <- read_excel("SitRep01.xlsm", sheet = 5, range = "J44:N44", col_names = F)
AU2_1700 <- read_excel("SitRep01.xlsm", sheet = 5, range = "J47:N47", col_names = F)
AU_1700 <- rbind(AU1_1700, AU2_1700)
View(AU_1700)
AU_1300 <- AU_1300 %>%
select(-...2) %>%
select("Now" = ...1,
"Beds" = ...3,
"DC" = ...4,
"Ongoing" =...5)
AU_1700 <- AU_1700 %>%
select(-...2) %>%
select("Now" = ...1,
"Beds" = ...3,
"DC" = ...4,
"Ongoing" =...5)
EC_1900 <- read_excel("SitRep01.xlsm", sheet = 6, range = "A6:F13", col_names = F)
EC_1900 <- read_excel("SitRep01.xlsm", sheet = 6, range = "A6:F13", col_names = F)
View(EC_1900)
EC_1900$...1 <- gsub(":", "", EC_1900$...1)
EC_1900 <- EC_1900 %>%
select("FLow" = ...1,
"Numbers" = ...6)
PC_1900 <- read_excel("SitRep01.xlsm", sheet = 6, range = "H6:K13", col_names = F)
PC_1900$...1 <- gsub(":", "", PC_1900$...1)
PC_1900 <- PC_1900 %>%
select("Flow" = ...1,
"Numbers" = ...4)
View(PC_1900)
total_1900 <- read_excel("SitRep01.xlsm", sheet = 6, range = "M6:O13", col_names = F)
total_1900$...1 <- gsub(":", "", total_1900$...1)
total_1900 <- total_1900 %>%
select("Flow" = ...1,
"Numbers" = ...3)
View(total_1900)
columns_1900 <- c("Ward",
"Access",
"Planned",
"Empty",
"Electives",
"DC_Expect",
"DC_5pm",
"End_Pos")
med_1900 <- read_excel("SitRep01.xlsm", sheet = 6, range = "A18:H32", col_names = columns_1900)
View(med_1900)
sx_1900 <- read_excel("SitRep01.xlsm", sheet = 6, range = "A34:H41", col_names = columns_1900)
View(sx_1900)
ortho_1900 <- read_excel("SitRep01.xlsm", sheet = 6, range = "A43:H45", col_names = columns_1900)
View(ortho_1900)
ED_1900 <- read_excel("SitRep01.xlsm", sheet = 6, range = "J18:P18", col_names = F)
colnames(ED_1900) <- c("Total",
"Longest",
"Assessment",
"Three_hours",
"DTA",
"Breaches",
"Midnight")
if(is.character(ED_1900$Longest) == T){
ED_1900$Longest <- ED_1900$Longest
}else{
ED_1900$Longest <- format(ED_1900$Longest, "%T")
}
if(is.character(ED_1900$Assessment) == T){
ED_1900$Assessment <- ED_1900$Assessment
}else{
ED_1900$Assessment <- format(ED_1900$Assessment, "%T")
}
View(ED_1900)
cc_1900 <- read_excel("SitRep01.xlsm", sheet = 6, range = "J25:O29", col_names = F)
colnames(cc_1900) <- c("Ward",
"Empty",
"Fit",
"Admissions",
"Discharges",
"End_Pos")
cc_1900[, 1] <- c("ITU",
"SHDU",
"MHDU",
"RHDU",
"CCU")
View(cc_1900)
add_1900 <- read_excel("SitRep01.xlsm", sheet = 6, range = "J34:N39", col_names = F)
add_1900 <- select(add_1900, -...3, -...5)
colnames(add_1900) <- c("Ward", "Agreed", "Used")
View(add_1900)
AU1_1900 <- read_excel("SitRep01.xlsm", sheet = 6, range = "J43:N43", col_names = F)
View(AU1_1900)
AU2_1900 <- read_excel("SitRep01.xlsm", sheet = 6, range = "J46:N46", col_names = F)
View(AU2_1900)
AU2_1900 <- read_excel("SitRep01.xlsm", sheet = 6, range = "J46:N46", col_names = F)
AU_1900 <- rbind(AU1_1900, AU2_1900)
View(AU_1900)
AU_1900 <- AU_1900 %>%
select(-...2) %>%
select("Now" = ...1,
"Beds" = ...3,
"DC" = ...4,
"Ongoing" =...5)
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
total_med <- c("Total",
colSums(med_830))
med_830 <- read_excel("SitRep01.xlsm", sheet = 3, range = "A18:L31", col_names = columns)
library(tidyverse)
library(readxl)
library(stringr)
library(stringi)
setwd("D:\\Lawrence\\Documents\\R_Projects\\VHKSitRep")
med_830 <- read_excel("SitRep01.xlsm", sheet = 3, range = "A18:L31", col_names = columns)
columns <- c("Ward",
"EDD_Due",
"EDD_Elapsed",
"Empty",
"Electives",
"DC_Expect",
"DC_12pm",
"End_Pos",
"Boarders",
"RN_Short",
"nRN_Short",
"Safe")
med_830 <- read_excel("SitRep01.xlsm", sheet = 3, range = "A18:L31", col_names = columns)
total_med <- c("Total",
colSums(med_830))
total_med <- c("Total",
colSums(med_830[, 2:12]))
total_med <- c("Total",
colSums(med_830[, 2:12], na.rm = T))
total_med <- c("Total",
colSums(med_830[, 2], na.rm = T))
total_med <- c("Total",
colSums(med_830[, 2], na.rm = T),
colSums(med_830[, 2], na.rm = T),
colSums(med_830[, 2], na.rm = T),
colSums(med_830[, 2], na.rm = T),
colSums(med_830[, 2], na.rm = T),
colSums(med_830[, 2], na.rm = T)
colSums(med_830[, 2], na.rm = T)
colSums(med_830[, 2], na.rm = T)
colSums(med_830[, 2], na.rm = T))
total_med <- c("Total",
colSums(med_830[, 2], na.rm = T),
colSums(med_830[, 3], na.rm = T),
colSums(med_830[, 4], na.rm = T),
colSums(med_830[, 5], na.rm = T),
colSums(med_830[, 6], na.rm = T),
colSums(med_830[, 7], na.rm = T),
colSums(med_830[, 8], na.rm = T),
colSums(med_830[, 9], na.rm = T),
colSums(med_830[, 10], na.rm = T),
NA)
total_med
med_830 <- rbind(med_830, total_med)
View(med_830)
total_med <- c("Total",
colSums(med_830[, 2], na.rm = T),
colSums(med_830[, 3], na.rm = T),
colSums(med_830[, 4], na.rm = T),
colSums(med_830[, 5], na.rm = T),
colSums(med_830[, 6], na.rm = T),
colSums(med_830[, 7], na.rm = T),
colSums(med_830[, 8], na.rm = T),
colSums(med_830[, 9], na.rm = T),
colSums(med_830[, 10], na.rm = T),
colSums(med_830[, 11], na.rm = T),
NA)
total_med <- c("Total",
colSums(med_830[, 2], na.rm = T),
colSums(med_830[, 3], na.rm = T),
colSums(med_830[, 4], na.rm = T),
colSums(med_830[, 5], na.rm = T),
colSums(med_830[, 6], na.rm = T),
colSums(med_830[, 7], na.rm = T),
colSums(med_830[, 8], na.rm = T),
colSums(med_830[, 9], na.rm = T),
colSums(med_830[, 10], na.rm = T),
colSums(med_830[, 11], na.rm = T),
NA)
columns <- c("Ward",
"EDD_Due",
"EDD_Elapsed",
"Empty",
"Electives",
"DC_Expect",
"DC_12pm",
"End_Pos",
"Boarders",
"RN_Short",
"nRN_Short",
"Safe")
med_830 <- read_excel("SitRep01.xlsm", sheet = 3, range = "A18:L31", col_names = columns)
total_med <- c("Total",
colSums(med_830[, 2], na.rm = T),
colSums(med_830[, 3], na.rm = T),
colSums(med_830[, 4], na.rm = T),
colSums(med_830[, 5], na.rm = T),
colSums(med_830[, 6], na.rm = T),
colSums(med_830[, 7], na.rm = T),
colSums(med_830[, 8], na.rm = T),
colSums(med_830[, 9], na.rm = T),
colSums(med_830[, 10], na.rm = T),
colSums(med_830[, 11], na.rm = T),
NA)
med_830 <- rbind(med_830, total_med)
View(med_830)
runApp()
runApp()
runApp()
sum_nrc <- read_excel("COVIDSitRep01.xlsm", sheet = 2, range = "B7:G13", col_names = F) %>%
select("Summary" = ...1,
"Numbers" = ...4)
library(tidyverse)
library(readxl)
library(stringr)
library(stringi)
setwd("D:\\Lawrence\\Documents\\R_Projects\\VHKSitRep")
sum_nrc <- read_excel("COVIDSitRep01.xlsm", sheet = 2, range = "B7:G13", col_names = F) %>%
select("Summary" = ...1,
"Numbers" = ...4)
View(sum_nrc)
sum_nrc <- read_excel("COVIDSitRep01.xlsm", sheet = 2, range = "B7:G13", col_names = F) %>%
select("Summary" = ...1,
"Numbers" = ...6)
View(sum_nrc)
sum_nrc <- read_excel("COVIDSitRep01.xlsm", sheet = 2, range = "B7:G13", col_names = F) %>%
select("Summary" = ...1,
"Numbers" = ...6)
