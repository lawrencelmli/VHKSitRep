mutate("RedZone" = ifelse(Ward %in% redzones_13, T, F))
shiny::runApp()
runApp()
source('~/R_Projects/VHKSitRep/dataExtract_covid_13.R')
library(tidyverse)
library(readxl)
library(stringr)
library(stringi)
setwd("D:\\Lawrence\\Documents\\R_Projects\\VHKSitRep")
covid13_sum <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "B7:E14", col_names = F) %>%
select(1, 4)
columns_13 <- c("Ward",
"Compliment",
"Empty",
"Electives",
"DC_Expected",
"DC_1pm")
covid13_flow <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "B19:G42", col_names = F)
colnames(covid13_flow) <- columns_13
covid13_flow$Empty <- as.numeric(covid13_flow$Empty)
redzones_13 <- c("AU1", "22", "34", "41", "43", "51", "53")
covid13_flow <- covid13_flow %>%
mutate("RedZone" = ifelse(Ward %in% redzones_13, T, F))
c13_flow_total <- data.frame("Totals",
colSums(covid13_flow[, 2]),
colSums(covid13_flow[, 3]),
colSums(covid13_flow[, 4]),
colSums(covid13_flow[, 5])
)
covid13_flow <- rbind(covid13_flow, c13_flow_total)
c13_flow_total <- data.frame("Totals",
colSums(covid13_flow[, 2]),
colSums(covid13_flow[, 3]),
colSums(covid13_flow[, 4]),
colSums(covid13_flow[, 5]),
colSums(covid13_flow[, 6])
)
covid13_flow <- rbind(covid13_flow, c13_flow_total)
c13_flow_total <- data.frame("Totals",
colSums(covid13_flow[, 2]),
colSums(covid13_flow[, 3]),
colSums(covid13_flow[, 4]),
colSums(covid13_flow[, 5]),
colSums(covid13_flow[, 6]),
NA
)
covid13_flow <- rbind(covid13_flow, c13_flow_total)
c13_flow_total <- c("Totals",
colSums(covid13_flow[, 2]),
colSums(covid13_flow[, 3]),
colSums(covid13_flow[, 4]),
colSums(covid13_flow[, 5]),
colSums(covid13_flow[, 6]),
NA
)
covid13_flow <- rbind(covid13_flow, c13_flow_total)
View(covid13_flow)
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
covid830_flow <- read_excel("COVIDSitRep01.xlsm", sheet = 3, range = "B19:J42", col_names = F)
colnames(covid830_flow) <- columns_830
covid830_flow$Empty <- as.numeric(covid830_flow$Empty)
redzones_830 <- c("AU1", "22", "34", "41", "43", "51", "53")
covid830_flow <- covid830_flow %>%
mutate("RedZone" = ifelse(Ward %in% redzones_830, T, F))
covid830_flow$Empty <- as.numeric(covid830_flow$Empty)
covid830_sum <- read_excel("COVIDSitRep01.xlsm", sheet = 3, range = "B7:E14", col_names = F) %>%
select(1, 4)
columns_830 <- c("Ward",
"Compliment",
"Empty",
"Electives",
"DC_Expected",
"DC_Achieved",
"RN",
"nRN",
"Safe")
covid830_flow <- read_excel("COVIDSitRep01.xlsm", sheet = 3, range = "B19:J42", col_names = F)
colnames(covid830_flow) <- columns_830
covid830_flow$Empty <- as.numeric(covid830_flow$Empty)
colSums(covid830_flow$Compliment)
sum(covid830_flow$Compliment)
sum(covid830_flow$Empty)
sum(covid830_flow$Empty, na.rm = T)
sum(covid13_flow[,4])
sum(covid13_flow$Electives)
sum(covid830_flow[,4])
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
covid830_wac[, 2:8] <- as.numeric(covid830_wac[, 2:8])
covid830_wac <- read_excel("COVIDSitRep01.xlsm", sheet = 3, range = "B52:J62", col_names = F)
covid830_wac[, 2:8] <- as.numeric(covid830_wac[, 2:8])
runApp()
runApp()
runApp()
runApp()
covid830_wac <- read_excel("COVIDSitRep01.xlsm", sheet = 3, range = "B52:J62", col_names = F)
colnames(covid830_wac) <- columns_830
columns_830 <- c("Ward",
"Compliment",
"Empty",
"Electives",
"DC_Expected",
"DC_Achieved",
"RN",
"nRN",
"Safe")
colnames(covid830_wac) <- columns_830
covid830_wac$Empty <- as.numeric(covid830_wac$Empty)
runApp()
runApp()
runApp()
setwd("D:\\Lawrence\\Documents\\R_Projects\\VHKSitRep")
[]
covid13_sum <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "B7:E14", col_names = F) %>%
select(1, 4)
columns_13 <- c("Ward",
"Compliment",
"Empty",
"Electives",
"DC_Expected",
"DC_1pm")
covid13_flow <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "B19:G42", col_names = F)
colnames(covid13_flow) <- columns_13
covid13_flow$Empty <- as.numeric(covid13_flow$Empty)
covid13_flow[8, 1] <- "22 Red"
covid13_flow[12, 1] <- "34 Red"
redzones_13 <- c("AU1", "22 Red", "34 Red", "41", "43", "51", "53")
View(covid13_flow)
covid13_flow <- covid13_flow %>%
mutate("RedZone" = ifelse(Ward %in% redzones_13, T, F))
c13_flow_total <- c("Totals",
colSums(covid13_flow[, 2]),
colSums(covid13_flow[, 3]),
colSums(covid13_flow[, 4]),
colSums(covid13_flow[, 5]),
colSums(covid13_flow[, 6]),
NA
)
covid13_flow <- rbind(covid13_flow, c13_flow_total)
c13_flow_total <- c("Totals",
colSums(covid13_flow[, 2]),colSums(covid13_flow[, 3]),
colSums(covid13_flow[, 4]),
colSums(covid13_flow[, 5]),
colSums(covid13_flow[, 6]),
NA
)
c13_flow_total <- c("Totals",
colSums(covid13_flow[, 2]),colSums(covid13_flow[, 3]),
colSums(covid13_flow[, 4]),
colSums(covid13_flow[, 5]),
colSums(covid13_flow[, 6]),
NA
)
covid13_seal <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "E43", col_names = F)
View(covid13_sum)
View(covid13_seal)
covid13_ortho <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "E45", col_names = F)
covid13_wac <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "B50:G60", col_names = F)
colnames(covid13_wac) <- columns_13
covid13_wac[, 1] <- c("Delivery Suite Red",
"Observation Unit Red",
"Maternity Ward Red",
"Delivery Suite",
"IOL",
"Observation Unit",
"Maternity Ward",
"Children's Ward",
"Children's Ward Red",
"Neonatal Unit",
"Neonatal Unit Red")
red_wac <- c("Delivery Suite Red",
"Observation Unit Red",
"Maternity Ward Red",
"Children's Ward Red",
"Neonatal Unit Red")
covid13_wac <- covid13_wac %>%
mutate("RedZones" = ifelse(Ward %in% red_wac, T, F))
covid13_ed <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "I19:M19", col_names = F)
View(covid13_ed)
if(!is.character(covid13_ed$...2)){
covid13_ed$...2 <- format(covid13_ed$...2, "%T")
}else{
covid13_ed$...2 <- covid13_ed$...2
}
if(!is.character(covid13_ed$...3)){
covid13_ed$...3 <- format(covid13_ed$...3, "%T")
}else{
covid13_ed$...3 <- covid13_ed$...3
}
covid13_ed <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "I19:M19", col_names = F)
covid13_ed <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "I19:M19", col_names = F)
if(!is.character(covid13_ed$...2)){
covid13_ed$...2 <- format(covid13_ed$...2, "%T")
}else{
covid13_ed$...2 <- covid13_ed$...2
}
if(!is.character(covid13_ed$...3)){
covid13_ed$...3 <- format(covid13_ed$...3, "%T")
}else{
covid13_ed$...3 <- covid13_ed$...3
}
covid13_cc <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "I26:N31", col_names = F)
View(covid13_cc)
columns_cc <- c("Ward",
"Empty",
"Fit",
"Admissions",
"DC_Expected",
"Compliment")
colnames(covid13_cc) <- columns_cc
covid13_cc$Empty <- as.numeric(covid13_cc$Empty)
covid13_cc <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "I26:N31", col_names = F)
columns_cc <- c("Ward",
"Empty",
"Fit",
"Admissions",
"DC_Expected",
"Compliment")
colnames(covid13_cc) <- columns_cc
covid13_cc$Empty <- as.numeric(covid13_cc$Empty)
columns_au <- c("Patients",
"Required",
"Discharges",
"Ongoing",
"TCI")
covid13_au1 <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "I37:M37", col_names = F)
View(covid13_au1)
colnames(covid13_au1) <- columns_au
covid13_au2 <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "I44:M44", col_names = F)
colnames(covid13_au2) <- columns_au
View(covid13_au2)
covid13_add <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "L50:M53", col_names = F)
colnames(covid13_add) <- c("Ward",
"Agreed.1",
"Agreed.2",
"InUse.1",
"InUse.2")
View(covid13_add)
covid13_add <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "I50:M53", col_names = F)
colnames(covid13_add) <- c("Ward",
"Agreed.1",
"Agreed.2",
"InUse.1",
"InUse.2")
View(covid13_add)
install.packages(c("class", "DescTools", "eeptools", "foreign", "KernSmooth", "labelled", "MASS", "modelr", "nnet", "RcppArmadillo", "rematch2", "rlang", "spatial", "tibble", "xml2", "zoo"))
install.packages(c("rlang", "xml2", "zoo"))
install.packages(c("rlang", "xml2", "zoo"), type = "source")
shiny::runApp()
library(tidyverse)
library(readxl)
library(stringr)
library(stringi)
setwd("D:\\Lawrence\\Documents\\R_Projects\\VHKSitRep")
covid13_sum <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "B7:E14", col_names = F) %>%
select(1, 4)
View(covid13_sum)
covid13_sum <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "B7:E14", col_names = F)
View(covid13_sum)
covid13_sum <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "B7:E14", col_names = F)
View(covid13_sum)
covid13_sum <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "B7:E14", col_names = F)
covid13_sum <- read_excel("COVIDSitRep01.xlsm", sheet = 4, range = "B7:E14", col_names = F) %>%
select(1, 4)
runApp()
)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?infoBoxOutput
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
covid17_sum <- read_excel("COVIDSitRep01.xlsm", sheet = 5, range = "B7:E14", col_names = F) %>%
select(1, 4)
View(covid17_sum)
View(covid17_sum)
View(covid17_sum)
covid17_sum <- read_excel("COVIDSitRep01.xlsm", sheet = 6, range = "B7:E14", col_names = F) %>%
select(1, 4)
View(covid17_sum)
covid17_sum <- read_excel("COVIDSitRep01.xlsm", sheet = 7, range = "B7:E14", col_names = F) %>%
select(1, 4)
View(covid17_sum)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?cut
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
critcare <- read_excel("SitRep01.xlsm", sheet = 1, range = "F14:H18", col_names = F)
critcare <- critcare[, -2]
Compliment <- stri_extract_all_regex(critcare[, 1], "[0-9]+")
Compliment <- as.numeric(Compliment[[1]])
critcare <- cbind(critcare, Compliment)
colnames(critcare) <- c("Ward", "Empty", "Compliment")
critcare$Ward <- gsub("[0-9]+", "", critcare$Ward)
critcare$Ward <- gsub(" \\(", "", critcare$Ward)
critcare$Ward <- gsub("\\)", "", critcare$Ward)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
setwd("D:\\Lawrence\\Documents\\R_Projects\\VHKSitRep")
library(tidyverse)
library(readxl)
library(stringr)
library(stringi)
adult_occ3 <- read_excel("SitRep01.xlsm", sheet = 2, range = "I2", col_names = F)
View(adult_occ3)
adult_occ3 <- read_excel("SitRep01.xlsm", sheet = 2, range = "J2", col_names = F)
adult_occ3 <- read_excel("SitRep01.xlsm", sheet = 2, range = "J2", col_names = F)
View(adult_occ3)
adult_occ3 <- read_excel("SitRep01.xlsm", sheet = 2, range = "I2", col_names = F)
View(adult_occ3)
adult_occ3
adult_occ1 <- read_excel("SitRep01.xlsm", sheet = 2, range = "E2", col_names = F)
adult_occ2 <- read_excel("SitRep01.xlsm", sheet = 2, range = "G2", col_names = F)
adult_occ3 <- adult_occ1/adult_occ2
adult_occ1 <- read_excel("SitRep01.xlsm", sheet = 2, range = "E2", col_names = F)
View(adult_occ1)
View(adult_occ1)
View(adult_occ1)
View(adult_occ1)
adult_occ1 <- read_excel("SitRep01.xlsm", sheet = 2, range = "E2", col_names = F)
source('~/R_Projects/VHKSitRep/data_other_scripts/dataExtract.R')
adult_occ1 <- read_excel("SitRep01.xlsm", sheet = 2, range = "E2", col_names = F)
adult_occ1 <- read_excel("SitRep01.xlsm", sheet = 2, range = "E2:E2", col_names = F)
adult_occ2 <- read_excel("SitRep01.xlsm", sheet = 2, range = "G2", col_names = F)
add_occ1 <- read_excel("SitRep01.xlsm", sheet = 2, range = "E3", col_names = F)
add_occ2 <- read_excel("SitRep01.xlsm", sheet = 2, range = "G3", col_names = F)
adult_occ1 <- read_excel("SitRep01.xlsm", sheet = 2, range = "A2:E2", col_names = F)
adult_occ1 <- read_excel("SitRep02.xlsm", sheet = 2, range = "E2", col_names = F)
library(tidyverse)
library(readxl)
library(stringr)
library(stringi)
setwd("D:\\Lawrence\\Documents\\R_Projects\\VHKSitRep")
adult_occ1 <- read_excel("SitRep02.xlsm", sheet = 2, range = "E2", col_names = F)
View(adult_occ1)
adult_occ2 <- read_excel("SitRep02.xlsm", sheet = 2, range = "G2", col_names = F)
adult_occ3 <- adult_occ1/adult_occ2
View(adult_occ3)
add_occ1 <- read_excel("SitRep02.xlsm", sheet = 2, range = "E3", col_names = F)
add_occ2 <- read_excel("SitRep02.xlsm", sheet = 2, range = "G3", col_names = F)
add_occ3 <- add_occ1/add_occ2
adult_occ1 <- read_excel("SitRep01.xlsm", sheet = 2, range = "E2", col_names = F)
View(add_occ1)
adult_occ1 <- read_excel("SitRep01.xlsm", sheet = 2, range = "E2", col_names = F)
ED_present <- read_excel("SitRep01.xlsm", sheet = 2, range = "E6", col_names = F)
ED_breach <- read_excel("SitRep01.xlsm", sheet = 2, range = "E7", col_names = F)
ED_perform <- (ED_present - ED_breach)/ED_present
EC_admit1 <- read_excel("SitRep01.xlsm", sheet = 2, range = "E8", col_names = F)
EC_admit2 <- read_excel("SitRep01.xlsm", sheet = 2, range = "G8", col_names = F)
EC_discharge1 <- read_excel("SitRep01.xlsm", sheet = 2, range = "L8", col_names = F)
EC_discharge2 <- read_excel("SitRep01.xlsm", sheet = 2, range = "M8", col_names = F)
EC_discharge3 <- read_excel("SitRep01.xlsm", sheet = 2, range = "o8", col_names = F)
View(EC_discharge3)
PC_discharge3 <- read_excel("SitRep01.xlsm", sheet = 2, range = "O9", col_names = F)
AA_present <- read_excel("SitRep01.xlsm", sheet = 2, range = "E12", col_names = F)
View(AA_present)
AA_discharge_total <- read_excel("SitRep01.xlsm", sheet = 2, range = "M9", col_names = F)
AA_discharge_total <- read_excel("SitRep01.xlsm", sheet = 2, range = "M12", col_names = F)
total_patients <- read_excel("SitRep01.xlsm", sheet = 2, range = "M10", col_names = F)
View(total_patients)
AU1_tansfer3 <- read_excel("SitRep01.xlsm", sheet = 2, range = "N14", col_names = F)
HAN_table <- read_excel("SitRep01.xlsm", sheet = 2, range = "A17:F22", col_names = F)
View(HAN_table)
HAN_table <- HAN_table %>%
select(-2:5)
select(-c(2:5)
select(c(-2:5)
HAN_table <- HAN_table %>%
select(c(-2:5))
HAN_table <- HAN_table %>%
select(-c(2:5))
View(HAN_table)
HAN_table <- read_excel("SitRep01.xlsm", sheet = 2, range = "A17:F22", col_names = F)
View(HAN_table)
HAN_table <- HAN_table %>%
select(-c(2:4))
View(HAN_table)
HAN_table <- read_excel("SitRep01.xlsm", sheet = 2, range = "A17:F22", col_names = F)
HAN_table <- HAN_table %>%
select(-c(2:5))
View(HAN_table)
colnames(HAN_table) <- c("event", "numbers")
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
